============================= test session starts =============================
platform win32 -- Python 3.14.2, pytest-9.0.2, pluggy-1.6.0 -- C:\Python\Python314\python.exe
cachedir: .pytest_cache
rootdir: D:\00_TestProject\oracle-duckdb-sync
configfile: pyproject.toml
plugins: base-url-2.1.0, cov-7.0.0, playwright-0.7.2
collecting ... collected 193 items

test/test_001.py::test_001_pytest_basic PASSED                           [  0%]
test/test_cached_query_v2.py::TestFetchRawData::test_fetch_data_successfully PASSED [  1%]
test/test_cached_query_v2.py::TestFetchRawData::test_fetch_empty_table PASSED [  1%]
test/test_cached_query_v2.py::TestCachedConvertDataframe::test_convert_dataframe_successfully PASSED [  2%]
test/test_cached_query_v2.py::TestCachedConvertDataframe::test_caching_works PASSED [  2%]
test/test_cached_query_v2.py::TestQueryDuckDBTableCached::test_successful_query_and_conversion PASSED [  3%]
test/test_cached_query_v2.py::TestQueryDuckDBTableCached::test_handles_fetch_failure PASSED [  3%]
test/test_cached_query_v2.py::TestQueryDuckDBTableCached::test_handles_conversion_failure FAILED [  4%]
test/test_config.py::test_010_load_oracle_config PASSED                  [  4%]
test/test_config.py::test_011_load_duckdb_config PASSED                  [  5%]
test/test_config.py::test_012_missing_config_raises_error PASSED         [  5%]
test/test_config.py::test_013_default_values PASSED                      [  6%]
test/test_config.py::test_014_sync_table_config PASSED                   [  6%]
test/test_config.py::test_015_sync_table_default_duckdb_name PASSED      [  7%]
test/test_config.py::test_016_sync_table_default_values PASSED           [  7%]
test/test_config.py::test_017_performance_settings_defaults PASSED       [  8%]
test/test_config.py::test_018_performance_settings_from_env PASSED       [  8%]
test/test_config.py::test_019_file_path_settings_defaults PASSED         [  9%]
test/test_config.py::test_020_file_path_settings_from_env PASSED         [  9%]
test/test_data_converter.py::TestNumericStringDetection::test_pure_numeric_strings FAILED [ 10%]
test/test_data_converter.py::TestNumericStringDetection::test_float_strings FAILED [ 10%]
test/test_data_converter.py::TestNumericStringDetection::test_mixed_with_nulls FAILED [ 11%]
test/test_data_converter.py::TestNumericStringDetection::test_non_numeric_strings FAILED [ 11%]
test/test_data_converter.py::TestNumericStringDetection::test_mostly_numeric FAILED [ 12%]
test/test_data_converter.py::TestNumericStringDetection::test_empty_series PASSED [ 12%]
test/test_data_converter.py::TestDatetimeStringDetection::test_yyyymmddhhmmss_format FAILED [ 13%]
test/test_data_converter.py::TestDatetimeStringDetection::test_yyyymmdd_format FAILED [ 13%]
test/test_data_converter.py::TestDatetimeStringDetection::test_iso_format FAILED [ 14%]
test/test_data_converter.py::TestDatetimeStringDetection::test_slash_format FAILED [ 15%]
test/test_data_converter.py::TestDatetimeStringDetection::test_non_datetime_strings FAILED [ 15%]
test/test_data_converter.py::TestDatetimeStringDetection::test_numeric_but_not_datetime FAILED [ 16%]
test/test_data_converter.py::TestDatetimeConversion::test_convert_yyyymmddhhmmss PASSED [ 16%]
test/test_data_converter.py::TestDatetimeConversion::test_convert_yyyymmdd PASSED [ 17%]
test/test_data_converter.py::TestDatetimeConversion::test_convert_iso_format PASSED [ 17%]
test/test_data_converter.py::TestDatetimeConversion::test_convert_with_nulls PASSED [ 18%]
test/test_data_converter.py::TestNumericConversion::test_convert_integer_strings PASSED [ 18%]
test/test_data_converter.py::TestNumericConversion::test_convert_float_strings PASSED [ 19%]
test/test_data_converter.py::TestNumericConversion::test_convert_with_nulls PASSED [ 19%]
test/test_data_converter.py::TestDetectColumnType::test_detect_numeric_type PASSED [ 20%]
test/test_data_converter.py::TestDetectColumnType::test_detect_datetime_type PASSED [ 20%]
test/test_data_converter.py::TestDetectColumnType::test_detect_string_type PASSED [ 21%]
test/test_data_converter.py::TestDetectColumnType::test_datetime_takes_precedence_over_numeric PASSED [ 21%]
test/test_data_converter.py::TestDetectColumnType::test_custom_threshold PASSED [ 22%]
test/test_data_converter.py::TestConvertColumnToType::test_convert_to_numeric_type PASSED [ 22%]
test/test_data_converter.py::TestConvertColumnToType::test_convert_to_datetime_type PASSED [ 23%]
test/test_data_converter.py::TestConvertColumnToType::test_convert_to_string_type_unchanged PASSED [ 23%]
test/test_data_converter.py::TestDetectAndConvertTypes::test_convert_mixed_dataframe PASSED [ 24%]
test/test_data_converter.py::TestDetectAndConvertTypes::test_preserve_existing_types PASSED [ 24%]
test/test_data_converter.py::TestDetectAndConvertTypes::test_empty_dataframe PASSED [ 25%]
test/test_data_converter.py::TestDetectAndConvertTypes::test_oracle_varchar2_scenario PASSED [ 25%]
test/test_data_query.py::TestGetTableRowCount::test_get_row_count_for_existing_table PASSED [ 26%]
test/test_data_query.py::TestGetTableRowCount::test_get_row_count_for_empty_table PASSED [ 26%]
test/test_data_query.py::TestGetTableRowCount::test_get_row_count_with_no_result PASSED [ 27%]
test/test_data_query.py::TestGetTableRowCount::test_get_row_count_with_exception PASSED [ 27%]
test/test_data_query.py::TestGetTableRowCount::test_get_row_count_for_large_table PASSED [ 28%]
test/test_data_query.py::TestQueryDuckDBTableAggregated::test_aggregated_query_with_valid_timestamp_column PASSED [ 29%]
test/test_data_query.py::TestQueryDuckDBTableAggregated::test_aggregated_query_with_no_numeric_columns PASSED [ 29%]
test/test_data_query.py::TestQueryDuckDBTableAggregated::test_aggregated_query_with_empty_result PASSED [ 30%]
test/test_data_query.py::TestQueryDuckDBTableAggregated::test_aggregated_query_exception_handling PASSED [ 30%]
test/test_duckdb_source.py::test_040_duckdb_ping PASSED                  [ 31%]
test/test_duckdb_source.py::test_041_ensure_database PASSED              [ 31%]
test/test_duckdb_source.py::test_042_column_type_mapping PASSED          [ 32%]
test/test_duckdb_source.py::test_050_batch_insert FAILED                 [ 32%]
test/test_duckdb_source.py::test_051_create_table_query PASSED           [ 33%]
test/test_duckdb_source.py::test_041b_disconnect_cleanup PASSED          [ 33%]
test/test_e2e.py::test_130_full_sync_e2e PASSED                          [ 34%]
test/test_e2e.py::test_131_incremental_sync_e2e_real_db FAILED           [ 34%]
test/test_imports.py::test_002_oracledb_import PASSED                    [ 35%]
test/test_imports.py::test_003_duckdb_import PASSED                      [ 35%]
test/test_imports.py::test_004_ui_libraries_import PASSED                [ 36%]
test/test_logger.py::test_100_logger_initialization PASSED               [ 36%]
test/test_logger.py::test_101_stats_logging PASSED                       [ 37%]
test/test_logger.py::test_102_logger_levels PASSED                       [ 37%]
test/test_lttb.py::TestLTTBCore::test_no_downsampling_when_below_threshold PASSED [ 38%]
test/test_lttb.py::TestLTTBCore::test_always_includes_first_and_last_points PASSED [ 38%]
test/test_lttb.py::TestLTTBCore::test_returns_correct_number_of_points PASSED [ 39%]
test/test_lttb.py::TestLTTBCore::test_preserves_peak PASSED              [ 39%]
test/test_lttb.py::TestLTTBCore::test_preserves_valley PASSED            [ 40%]
test/test_lttb.py::TestLTTBDownsample::test_dataframe_input PASSED       [ 40%]
test/test_lttb.py::TestLTTBDownsample::test_numpy_array_input PASSED     [ 41%]
test/test_lttb.py::TestLTTBDownsample::test_datetime_x_column PASSED     [ 41%]
test/test_lttb.py::TestLTTBDownsample::test_raises_error_for_missing_columns PASSED [ 42%]
test/test_lttb.py::TestLTTBDownsample::test_raises_error_for_invalid_numpy_shape PASSED [ 43%]
test/test_lttb.py::TestLTTBDownsampleMultiY::test_multi_column_downsampling PASSED [ 43%]
test/test_lttb.py::TestLTTBDownsampleMultiY::test_no_downsampling_when_below_threshold PASSED [ 44%]
test/test_lttb.py::TestLTTBDownsampleMultiY::test_preserves_outliers_in_primary_column PASSED [ 44%]
test/test_lttb.py::TestLTTBDownsampleMultiY::test_handles_nan_values PASSED [ 45%]
test/test_lttb.py::TestLTTBDownsampleMultiY::test_empty_y_cols_raises_error PASSED [ 45%]
test/test_lttb.py::TestLTTBPerformance::test_large_dataset_performance PASSED [ 46%]
test/test_lttb.py::TestLTTBPerformance::test_very_large_dataset PASSED   [ 46%]
test/test_lttb.py::TestLTTBVisualizationIntegration::test_trend_preservation PASSED [ 47%]
test/test_lttb.py::TestLTTBVisualizationIntegration::test_min_max_preservation PASSED [ 47%]
test/test_oracle_source.py::test_020_oracle_connection_creation FAILED   [ 48%]
test/test_oracle_source.py::test_021_oracle_connection_failure PASSED    [ 48%]
test/test_oracle_source.py::test_022_oracle_pool_initialization PASSED   [ 49%]
test/test_oracle_source.py::test_030_fetch_all_data PASSED               [ 49%]
test/test_oracle_source.py::test_031_fetch_batch_data PASSED             [ 50%]
test/test_oracle_source.py::test_031b_fetch_batch_pagination PASSED      [ 50%]
test/test_oracle_source.py::test_032_incremental_query PASSED            [ 51%]
test/test_oracle_source.py::test_033_date_conversion_handler PASSED      [ 51%]
test/test_performance.py::test_132_chart_rendering_performance_100k_rows PASSED [ 52%]
test/test_performance.py::test_133_incremental_sync_performance_10k_rows FAILED [ 52%]
test/test_resource_cleanup.py::test_sync_engine_max_iterations PASSED    [ 53%]
test/test_resource_cleanup.py::test_sync_engine_timeout PASSED           [ 53%]
test/test_resource_cleanup.py::test_duckdb_connection_cleanup PASSED     [ 54%]
test/test_resource_cleanup.py::test_oracle_cursor_cleanup_on_exception PASSED [ 54%]
test/test_resource_cleanup.py::test_logger_handler_cleanup PASSED        [ 55%]
test/test_scheduler.py::test_110_scheduler_setup PASSED                  [ 55%]
test/test_scheduler.py::test_111_duplicate_execution_prevention PASSED   [ 56%]
test/test_scheduler.py::test_112_safe_scheduler_restart PASSED           [ 56%]
test/test_schema_version.py::test_141_schema_mapping_version_management PASSED [ 57%]
test/test_selective_conversion.py::TestDetectConvertibleColumns::test_detect_numeric_column PASSED [ 58%]
test/test_selective_conversion.py::TestDetectConvertibleColumns::test_detect_datetime_column PASSED [ 58%]
test/test_selective_conversion.py::TestDetectConvertibleColumns::test_no_convertible_columns PASSED [ 59%]
test/test_selective_conversion.py::TestDetectConvertibleColumns::test_skip_already_converted_columns PASSED [ 59%]
test/test_selective_conversion.py::TestDetectConvertibleColumns::test_empty_dataframe PASSED [ 60%]
test/test_selective_conversion.py::TestConvertSelectedColumns::test_convert_single_numeric_column PASSED [ 60%]
test/test_selective_conversion.py::TestConvertSelectedColumns::test_convert_multiple_columns PASSED [ 61%]
test/test_selective_conversion.py::TestConvertSelectedColumns::test_convert_no_columns PASSED [ 61%]
test/test_selective_conversion.py::TestConvertSelectedColumns::test_skip_nonexistent_column PASSED [ 62%]
test/test_selective_conversion.py::TestConvertSelectedColumns::test_empty_dataframe PASSED [ 62%]
test/test_selective_conversion.py::TestSelectiveConversionIntegration::test_detect_then_convert_workflow PASSED [ 63%]
test/test_selective_conversion.py::TestSelectiveConversionIntegration::test_user_overrides_suggestion PASSED [ 63%]
test/test_state_file_manager.py::TestStateFileManager::test_save_json_creates_file PASSED [ 64%]
test/test_state_file_manager.py::TestStateFileManager::test_save_json_creates_directory_if_not_exists PASSED [ 64%]
test/test_state_file_manager.py::TestStateFileManager::test_save_json_overwrites_existing_file PASSED [ 65%]
test/test_state_file_manager.py::TestStateFileManager::test_load_json_returns_data PASSED [ 65%]
test/test_state_file_manager.py::TestStateFileManager::test_load_json_returns_default_if_file_not_found PASSED [ 66%]
test/test_state_file_manager.py::TestStateFileManager::test_load_json_returns_empty_dict_if_no_default PASSED [ 66%]
test/test_state_file_manager.py::TestStateFileManager::test_load_json_handles_corrupted_json PASSED [ 67%]
test/test_state_file_manager.py::TestStateFileManager::test_save_json_handles_io_error PASSED [ 67%]
test/test_state_file_manager.py::TestStateFileManager::test_save_json_formats_with_indent PASSED [ 68%]
test/test_state_rollback.py::test_142_state_rollback_on_failure_and_restart FAILED [ 68%]
test/test_state_rollback.py::test_142_partial_progress_tracking PASSED   [ 69%]
test/test_streamlit_ui.py::test_streamlit_ui_responsiveness FAILED       [ 69%]
test/test_sync_engine.py::test_070_full_sync_pipeline PASSED             [ 70%]
test/test_sync_engine.py::test_072_batch_sync_processing PASSED          [ 70%]
test/test_sync_engine.py::test_080_incremental_sync_query PASSED         [ 71%]
test/test_sync_engine.py::test_082_retry_on_failure PASSED               [ 72%]
test/test_sync_engine.py::test_071_full_sync_progress_logging PASSED     [ 72%]
test/test_sync_engine.py::test_081_incremental_upsert_handling PASSED    [ 73%]
test/test_sync_engine.py::test_083_save_load_sync_state PASSED           [ 73%]
test/test_sync_engine.py::test_140_sync_state_save_and_load PASSED       [ 74%]
test/test_sync_state.py::test_sync_lock_acquire_release PASSED           [ 74%]
test/test_sync_state.py::test_sync_lock_concurrent PASSED                [ 75%]
test/test_sync_state.py::test_sync_lock_context_manager PASSED           [ 75%]
test/test_sync_state.py::test_sync_lock_stale_detection PASSED           [ 76%]
test/test_sync_state.py::test_sync_lock_get_info PASSED                  [ 76%]
test/test_sync_worker.py::test_150_sync_worker_thread_lifecycle FAILED   [ 77%]
test/test_sync_worker.py::test_150_sync_worker_status_transitions PASSED [ 77%]
test/test_sync_worker.py::test_150_sync_worker_error_handling FAILED     [ 78%]
test/test_sync_worker.py::test_151_progress_callback_and_queue FAILED    [ 78%]
test/test_sync_worker.py::test_151_progress_queue_optional FAILED        [ 79%]
test/test_sync_worker.py::test_152_pause_resume_control FAILED           [ 79%]
test/test_sync_worker.py::test_152_pause_state_transitions FAILED        [ 80%]
test/test_ui.py::test_120_streamlit_page_config PASSED                   [ 80%]
test/test_ui_handlers_refactoring.py::TestValidateTableName::test_empty_table_name_shows_warning PASSED [ 81%]
test/test_ui_handlers_refactoring.py::TestValidateTableName::test_none_table_name_shows_warning PASSED [ 81%]
test/test_ui_handlers_refactoring.py::TestValidateTableName::test_valid_table_name_returns_true PASSED [ 82%]
test/test_ui_handlers_refactoring.py::TestAcquireSyncLockWithUI::test_lock_already_acquired_shows_warning PASSED [ 82%]
test/test_ui_handlers_refactoring.py::TestAcquireSyncLockWithUI::test_lock_acquisition_failure_shows_error PASSED [ 83%]
test/test_ui_handlers_refactoring.py::TestAcquireSyncLockWithUI::test_successful_lock_acquisition_returns_lock PASSED [ 83%]
test/test_ui_handlers_refactoring.py::TestStartSyncWorker::test_worker_starts_successfully PASSED [ 84%]
test/test_ui_handlers_refactoring.py::TestStartSyncWorker::test_worker_sets_expected_rows_for_test_sync PASSED [ 84%]
test/test_ui_handlers_refactoring.py::TestHandleSyncError::test_error_releases_lock_and_shows_message PASSED [ 85%]
test/test_ui_handlers_refactoring.py::TestHandleSyncError::test_error_displays_traceback PASSED [ 86%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_varied_values PASSED [ 86%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_identical_values PASSED [ 87%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_nan_values PASSED [ 87%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_all_nan_values PASSED [ 88%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_empty_array PASSED [ 88%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_zero_values PASSED [ 89%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_custom_padding PASSED [ 89%]
test/test_visualization.py::TestCalculateYAxisRange::test_calculate_range_with_small_variations PASSED [ 90%]
test/test_visualization.py::TestRenderDataVisualization::test_none_dataframe PASSED [ 90%]
test/test_visualization.py::TestRenderDataVisualization::test_empty_dataframe PASSED [ 91%]
test/test_visualization.py::TestRenderDataVisualization::test_dataframe_without_numeric_or_datetime_columns PASSED [ 91%]
test/test_visualization.py::TestRenderDataVisualization::test_dataframe_with_numeric_columns PASSED [ 92%]
test/test_visualization.py::TestRenderDataVisualization::test_dataframe_with_datetime_columns PASSED [ 92%]
test/test_visualization.py::TestRenderDataVisualization::test_dataframe_with_mixed_types PASSED [ 93%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_single_column_within_range PASSED [ 93%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_excludes_values_below_min PASSED [ 94%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_excludes_values_above_max PASSED [ 94%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_with_outliers PASSED [ 95%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_with_no_exclusions PASSED [ 95%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_with_all_exclusions PASSED [ 96%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_preserves_other_columns PASSED [ 96%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_with_nan_values PASSED [ 97%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_boundary_values_inclusive PASSED [ 97%]
test/test_visualization.py::TestFilterDataframeByRange::test_filter_preserves_row_index PASSED [ 98%]
test/test_visualization.py::TestYAxisRangeAfterFiltering::test_y_axis_range_uses_filtered_data PASSED [ 98%]
test/test_visualization.py::TestYAxisRangeAfterFiltering::test_y_axis_range_without_outliers_removed PASSED [ 99%]
test/test_visualization.py::TestYAxisRangeAfterFiltering::test_y_axis_range_with_multiple_similar_columns_after_filtering PASSED [100%]

================================== FAILURES ===================================
_________ TestQueryDuckDBTableCached.test_handles_conversion_failure __________
test\test_cached_query_v2.py:166: in test_handles_conversion_failure
    assert result['success'] is False
E   assert True is False
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:02:42,724 - DataConverter - INFO - Processing 2 columns in parallel with 4 workers
2025-12-30 14:02:42,728 - DataConverter - INFO - Successfully converted column 'col1' to numeric (100.0% success rate)
2025-12-30 14:02:42,731 - DataConverter - INFO - Successfully converted column 'col2' to numeric (100.0% success rate)
2025-12-30 14:02:42,732 - DataConverter - INFO - [1/2] Converted column 'col1' to numeric
2025-12-30 14:02:42,733 - DataConverter - INFO - [2/2] Converted column 'col2' to numeric
2025-12-30 14:02:42,734 - DataConverter - INFO - Type conversion summary: 2 numeric, 0 datetime, 0 unchanged
------------------------------ Captured log call ------------------------------
INFO     DataConverter:data_converter.py:313 Processing 2 columns in parallel with 4 workers
INFO     DataConverter:data_converter.py:190 Successfully converted column 'col1' to numeric (100.0% success rate)
INFO     DataConverter:data_converter.py:190 Successfully converted column 'col2' to numeric (100.0% success rate)
INFO     DataConverter:data_converter.py:328 [1/2] Converted column 'col1' to numeric
INFO     DataConverter:data_converter.py:328 [2/2] Converted column 'col2' to numeric
INFO     DataConverter:data_converter.py:349 Type conversion summary: 2 numeric, 0 datetime, 0 unchanged
____________ TestNumericStringDetection.test_pure_numeric_strings _____________
test\test_data_converter.py:25: in test_pure_numeric_strings
    assert is_numeric_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_numeric_string(0    123\n1    456\n2    789\n3      0\ndtype: object)
________________ TestNumericStringDetection.test_float_strings ________________
test\test_data_converter.py:30: in test_float_strings
    assert is_numeric_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_numeric_string(0     123.45\n1      67.89\n2      0.123\n3    999.999\ndtype: object)
______________ TestNumericStringDetection.test_mixed_with_nulls _______________
test\test_data_converter.py:35: in test_mixed_with_nulls
    assert is_numeric_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_numeric_string(0     123\n1    None\n2     456\n3     NaN\n4     789\ndtype: object)
_____________ TestNumericStringDetection.test_non_numeric_strings _____________
test\test_data_converter.py:40: in test_non_numeric_strings
    assert is_numeric_string(series) is False
E   assert np.False_ is False
E    +  where np.False_ = is_numeric_string(0    abc\n1    def\n2    ghi\ndtype: object)
_______________ TestNumericStringDetection.test_mostly_numeric ________________
test\test_data_converter.py:46: in test_mostly_numeric
    assert is_numeric_string(series) is False
E   assert np.False_ is False
E    +  where np.False_ = is_numeric_string(0    123\n1    456\n2    789\n3    abc\n4    999\ndtype: object)
___________ TestDatetimeStringDetection.test_yyyymmddhhmmss_format ____________
test\test_data_converter.py:60: in test_yyyymmddhhmmss_format
    assert is_datetime_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_datetime_string(0    20231219153045\n1    20240101120000\n2    20231231235959\ndtype: object)
______________ TestDatetimeStringDetection.test_yyyymmdd_format _______________
test\test_data_converter.py:65: in test_yyyymmdd_format
    assert is_datetime_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_datetime_string(0    20231219\n1    20240101\n2    20231231\ndtype: object)
_________________ TestDatetimeStringDetection.test_iso_format _________________
test\test_data_converter.py:70: in test_iso_format
    assert is_datetime_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_datetime_string(0    2023-12-19\n1    2024-01-01\n2    2023-12-31\ndtype: object)
________________ TestDatetimeStringDetection.test_slash_format ________________
test\test_data_converter.py:75: in test_slash_format
    assert is_datetime_string(series) is True
E   assert np.True_ is True
E    +  where np.True_ = is_datetime_string(0    2023/12/19\n1    2024/01/01\n2    2023/12/31\ndtype: object)
____________ TestDatetimeStringDetection.test_non_datetime_strings ____________
test\test_data_converter.py:80: in test_non_datetime_strings
    assert is_datetime_string(series) is False
E   assert np.False_ is False
E    +  where np.False_ = is_datetime_string(0    abc\n1    def\n2    ghi\ndtype: object)
__________ TestDatetimeStringDetection.test_numeric_but_not_datetime __________
test\test_data_converter.py:85: in test_numeric_but_not_datetime
    assert is_datetime_string(series) is False
E   assert np.False_ is False
E    +  where np.False_ = is_datetime_string(0    123\n1    456\n2    789\ndtype: object)
____________________________ test_050_batch_insert ____________________________
test\test_duckdb_source.py:76: in test_050_batch_insert
    mock_conn.executemany.assert_called()
C:\Python\Python314\Lib\unittest\mock.py:954: in assert_called
    raise AssertionError(msg)
E   AssertionError: Expected 'executemany' to have been called.
____________________ test_131_incremental_sync_e2e_real_db ____________________
test\test_e2e.py:158: in test_131_incremental_sync_e2e_real_db
    count_result = oracle_source.fetch_all(count_query)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\oracle_duckdb_sync\oracle_source.py:143: in fetch_all
    cursor.execute(query)
C:\Python\Python314\Lib\site-packages\oracledb\cursor.py:844: in execute
    impl.execute(self)
src/oracledb/impl/thick/cursor.pyx:320: in oracledb.thick_impl.ThickCursorImpl.execute
    ???
src/oracledb/impl/thick/utils.pyx:484: in oracledb.thick_impl._raise_from_odpi
    ???
src/oracledb/impl/thick/utils.pyx:474: in oracledb.thick_impl._raise_from_info
    ???
E   oracledb.exceptions.DatabaseError: ORA-00942: 테이블 또는 뷰가 존재하지 않습니다

During handling of the above exception, another exception occurred:
test\test_e2e.py:192: in test_131_incremental_sync_e2e_real_db
    raise Exception(f"Table {oracle_table} not found. Please check available tables above.")
E   Exception: Table CRASIVTTST not found. Please check available tables above.
---------------------------- Captured stdout call -----------------------------

[TEST-131] Incremental Sync E2E Test
  Oracle table: CRASIVTTST
  DuckDB table: IV
  Time column: FACTORY
  Primary key: FACTORY, LOT_ID, TRAN_TIME, OPER, RES_ID
2025-12-30 14:02:45,945 - OracleSource - INFO - Attempting connection to Oracle (Thick mode): 150.4.1.61:1521/MESDB
2025-12-30 14:02:45,946 - OracleSource - INFO - User: DUCKDB
2025-12-30 14:02:46,077 - OracleSource - INFO - Successfully connected to Oracle database

[ERROR] Table CRASIVTTST not found!
  Checking available tables for user DUCKDB...

  User tables (showing first 20):

  All accessible tables matching 'CRASIVTTST':
    - MESMGR.CRASIVTTST: 1808859 rows
------------------------------ Captured log call ------------------------------
INFO     OracleSource:oracle_source.py:77 Attempting connection to Oracle (Thick mode): 150.4.1.61:1521/MESDB
INFO     OracleSource:oracle_source.py:78 User: DUCKDB
INFO     OracleSource:oracle_source.py:88 Successfully connected to Oracle database
_____________________ test_020_oracle_connection_creation _____________________
test\test_oracle_source.py:29: in test_020_oracle_connection_creation
    assert call_kwargs["host"] == mock_config.oracle_host
           ^^^^^^^^^^^^^^^^^^^
E   KeyError: 'host'
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:02:48,176 - OracleSource - INFO - Attempting connection to Oracle (Thick mode): localhost:1521/xe
2025-12-30 14:02:48,176 - OracleSource - INFO - User: admin
2025-12-30 14:02:48,177 - OracleSource - INFO - Successfully connected to Oracle database
------------------------------ Captured log call ------------------------------
INFO     OracleSource:oracle_source.py:77 Attempting connection to Oracle (Thick mode): localhost:1521/xe
INFO     OracleSource:oracle_source.py:78 User: admin
INFO     OracleSource:oracle_source.py:88 Successfully connected to Oracle database
_______________ test_133_incremental_sync_performance_10k_rows ________________
test\test_performance.py:100: in test_133_incremental_sync_performance_10k_rows
    total_rows = engine.incremental_sync(
E   TypeError: SyncEngine.incremental_sync() got an unexpected keyword argument 'oracle_table'. Did you mean 'oracle_table_name'?
_______________ test_142_state_rollback_on_failure_and_restart ________________
test\test_state_rollback.py:67: in test_142_state_rollback_on_failure_and_restart
    engine.incremental_sync(
E   TypeError: SyncEngine.incremental_sync() got an unexpected keyword argument 'oracle_table'. Did you mean 'oracle_table_name'?

During handling of the above exception, another exception occurred:
test\test_state_rollback.py:66: in test_142_state_rollback_on_failure_and_restart
    with pytest.raises(Exception, match="Network error"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E     Expected regex: 'Network error'
E     Actual message: "SyncEngine.incremental_sync() got an unexpected keyword argument 'oracle_table'. Did you mean 'oracle_table_name'?"
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:02:52,670 - sync_engine - WARNING - File not found: C:\Users\170731\AppData\Local\Temp\pytest-of-170731\pytest-6\test_142_state_rollback_on_fai0\sync_state.json, using default
------------------------------ Captured log call ------------------------------
WARNING  sync_engine:state_file_manager.py:54 File not found: C:\Users\170731\AppData\Local\Temp\pytest-of-170731\pytest-6\test_142_state_rollback_on_fai0\sync_state.json, using default
______________________ test_streamlit_ui_responsiveness _______________________
test\test_streamlit_ui.py:18: in test_streamlit_ui_responsiveness
    page.goto('http://localhost:8501', wait_until='networkidle', timeout=30000)
C:\Python\Python314\Lib\site-packages\playwright\sync_api\_generated.py:9050: in goto
    self._sync(
C:\Python\Python314\Lib\site-packages\playwright\_impl\_page.py:552: in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Python\Python314\Lib\site-packages\playwright\_impl\_frame.py:153: in goto
    await self._channel.send(
C:\Python\Python314\Lib\site-packages\playwright\_impl\_connection.py:69: in send
    return await self._connection.wrap_api_call(
C:\Python\Python314\Lib\site-packages\playwright\_impl\_connection.py:559: in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
E   playwright._impl._errors.Error: Page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:8501/
E   Call log:
E     - navigating to "http://localhost:8501/", waiting until "networkidle"
---------------------------- Captured stdout call -----------------------------
\U0001f310 Opening Streamlit app at http://localhost:8501
____________________ test_150_sync_worker_thread_lifecycle ____________________
test\test_sync_worker.py:87: in test_150_sync_worker_thread_lifecycle
    assert worker.total_rows == 100
E   assert 0 == 100
E    +  where 0 = <oracle_duckdb_sync.sync_worker.SyncWorker object at 0x000001A70D670980>.total_rows
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:03:06,527 - sync_engine - INFO - Getting schema for table 
2025-12-30 14:03:06,528 - sync_engine - INFO - Creating table  in DuckDB
2025-12-30 14:03:06,529 - sync_engine - INFO - Dropping existing test table 
2025-12-30 14:03:06,529 - sync_engine - INFO - Creating test table WITHOUT PRIMARY KEY for faster inserts
2025-12-30 14:03:06,529 - sync_engine - INFO - Starting test sync from  to  (limit: 1000 rows)
2025-12-30 14:03:06,530 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,530 - sync_engine - INFO - Starting limited sync:  -> 
2025-12-30 14:03:06,530 - sync_engine - INFO - Row limit: 1000, Batch size: 10000
2025-12-30 14:03:06,530 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,531 - sync_engine - INFO - [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
2025-12-30 14:03:06,532 - sync_engine - INFO - [ORACLE] Query executed successfully
2025-12-30 14:03:06,532 - sync_engine - INFO - [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
2025-12-30 14:03:06,532 - sync_engine - INFO - [ORACLE] Fetching batch from Oracle...
2025-12-30 14:03:06,533 - sync_engine - INFO - [ORACLE] Fetched 0 rows from Oracle in 0.00s
2025-12-30 14:03:06,534 - sync_engine - INFO - [PROCESS] Converting datetime objects...
2025-12-30 14:03:06,534 - sync_engine - INFO - [PROCESS] Converted 0 rows
2025-12-30 14:03:06,534 - sync_engine - INFO - [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
2025-12-30 14:03:06,535 - sync_engine - INFO - [DUCKDB] Total insert completed in 0.00s
2025-12-30 14:03:06,535 - sync_engine - INFO - [PROGRESS] Total rows processed: 0/1000 (0.0%)
2025-12-30 14:03:06,535 - sync_engine - INFO - Sync progress - Table: , Total rows: 0, Batch size: 0
2025-12-30 14:03:06,535 - sync_engine - INFO - [COMPLETE] Got less than requested (0 < 1000). End of data.
2025-12-30 14:03:06,535 - sync_engine - INFO - [CLEANUP] Closing Oracle cursor...
2025-12-30 14:03:06,537 - sync_engine - INFO - [CLEANUP] Cursor closed
2025-12-30 14:03:06,537 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,538 - sync_engine - INFO - [SUMMARY] Test sync completed!
2025-12-30 14:03:06,538 - sync_engine - INFO - [SUMMARY] Total rows processed: 0
2025-12-30 14:03:06,538 - sync_engine - INFO - [SUMMARY] Row limit: 1000
2025-12-30 14:03:06,538 - sync_engine - INFO - [SUMMARY] Total time: 0.01 seconds
2025-12-30 14:03:06,538 - sync_engine - INFO - [SUMMARY] Processing rate: 0.00 rows/second
2025-12-30 14:03:06,538 - sync_engine - INFO - ================================================================================
------------------------------ Captured log call ------------------------------
INFO     sync_engine:sync_engine.py:62 Getting schema for table 
INFO     sync_engine:sync_engine.py:135 Creating table  in DuckDB
INFO     sync_engine:sync_engine.py:139 Dropping existing test table 
INFO     sync_engine:sync_engine.py:145 Creating test table WITHOUT PRIMARY KEY for faster inserts
INFO     sync_engine:sync_engine.py:151 Starting test sync from  to  (limit: 1000 rows)
INFO     sync_engine:sync_engine.py:431 ================================================================================
INFO     sync_engine:sync_engine.py:432 Starting limited sync:  -> 
INFO     sync_engine:sync_engine.py:433 Row limit: 1000, Batch size: 10000
INFO     sync_engine:sync_engine.py:434 ================================================================================
INFO     sync_engine:sync_engine.py:447 [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
INFO     sync_engine:sync_engine.py:449 [ORACLE] Query executed successfully
INFO     sync_engine:sync_engine.py:368 [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
INFO     sync_engine:sync_engine.py:283 [ORACLE] Fetching batch from Oracle...
INFO     sync_engine:sync_engine.py:291 [ORACLE] Fetched 0 rows from Oracle in 0.00s
INFO     sync_engine:sync_engine.py:304 [PROCESS] Converting datetime objects...
INFO     sync_engine:sync_engine.py:307 [PROCESS] Converted 0 rows
INFO     sync_engine:sync_engine.py:322 [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
INFO     sync_engine:sync_engine.py:326 [DUCKDB] Total insert completed in 0.00s
INFO     sync_engine:sync_engine.py:383 [PROGRESS] Total rows processed: 0/1000 (0.0%)
INFO     sync_engine:sync_engine.py:470 Sync progress - Table: , Total rows: 0, Batch size: 0
INFO     sync_engine:sync_engine.py:393 [COMPLETE] Got less than requested (0 < 1000). End of data.
INFO     sync_engine:sync_engine.py:458 [CLEANUP] Closing Oracle cursor...
INFO     sync_engine:sync_engine.py:460 [CLEANUP] Cursor closed
INFO     sync_engine:sync_engine.py:262 ================================================================================
INFO     sync_engine:sync_engine.py:263 [SUMMARY] Test sync completed!
INFO     sync_engine:sync_engine.py:264 [SUMMARY] Total rows processed: 0
INFO     sync_engine:sync_engine.py:265 [SUMMARY] Row limit: 1000
INFO     sync_engine:sync_engine.py:266 [SUMMARY] Total time: 0.01 seconds
INFO     sync_engine:sync_engine.py:269 [SUMMARY] Processing rate: 0.00 rows/second
INFO     sync_engine:sync_engine.py:270 ================================================================================
_____________________ test_150_sync_worker_error_handling _____________________
test\test_sync_worker.py:205: in test_150_sync_worker_error_handling
    assert worker.status == 'error'
E   AssertionError: assert 'completed' == 'error'
E     
E     - error
E     + completed
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:03:06,639 - sync_engine - INFO - Getting schema for table 
2025-12-30 14:03:06,640 - sync_engine - INFO - Creating table  in DuckDB
2025-12-30 14:03:06,640 - sync_engine - INFO - Dropping existing test table 
2025-12-30 14:03:06,640 - sync_engine - INFO - Creating test table WITHOUT PRIMARY KEY for faster inserts
2025-12-30 14:03:06,640 - sync_engine - INFO - Starting test sync from  to  (limit: 100 rows)
2025-12-30 14:03:06,641 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,641 - sync_engine - INFO - Starting limited sync:  -> 
2025-12-30 14:03:06,641 - sync_engine - INFO - Row limit: 100, Batch size: 10000
2025-12-30 14:03:06,642 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,642 - sync_engine - INFO - [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 100
2025-12-30 14:03:06,643 - sync_engine - INFO - [ORACLE] Query executed successfully
2025-12-30 14:03:06,643 - sync_engine - INFO - [BATCH 1] Preparing to fetch 100 rows (total so far: 0, remaining: 100)
2025-12-30 14:03:06,643 - sync_engine - INFO - [ORACLE] Fetching batch from Oracle...
2025-12-30 14:03:06,644 - sync_engine - INFO - [ORACLE] Fetched 0 rows from Oracle in 0.00s
2025-12-30 14:03:06,644 - sync_engine - INFO - [PROCESS] Converting datetime objects...
2025-12-30 14:03:06,645 - sync_engine - INFO - [PROCESS] Converted 0 rows
2025-12-30 14:03:06,645 - sync_engine - INFO - [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
2025-12-30 14:03:06,645 - sync_engine - INFO - [DUCKDB] Total insert completed in 0.00s
2025-12-30 14:03:06,646 - sync_engine - INFO - [PROGRESS] Total rows processed: 0/100 (0.0%)
2025-12-30 14:03:06,646 - sync_engine - INFO - Sync progress - Table: , Total rows: 0, Batch size: 0
2025-12-30 14:03:06,646 - sync_engine - INFO - [COMPLETE] Got less than requested (0 < 100). End of data.
2025-12-30 14:03:06,646 - sync_engine - INFO - [CLEANUP] Closing Oracle cursor...
2025-12-30 14:03:06,647 - sync_engine - INFO - [CLEANUP] Cursor closed
2025-12-30 14:03:06,647 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,647 - sync_engine - INFO - [SUMMARY] Test sync completed!
2025-12-30 14:03:06,647 - sync_engine - INFO - [SUMMARY] Total rows processed: 0
2025-12-30 14:03:06,647 - sync_engine - INFO - [SUMMARY] Row limit: 100
2025-12-30 14:03:06,647 - sync_engine - INFO - [SUMMARY] Total time: 0.01 seconds
2025-12-30 14:03:06,648 - sync_engine - INFO - [SUMMARY] Processing rate: 0.00 rows/second
2025-12-30 14:03:06,648 - sync_engine - INFO - ================================================================================
------------------------------ Captured log call ------------------------------
INFO     sync_engine:sync_engine.py:62 Getting schema for table 
INFO     sync_engine:sync_engine.py:135 Creating table  in DuckDB
INFO     sync_engine:sync_engine.py:139 Dropping existing test table 
INFO     sync_engine:sync_engine.py:145 Creating test table WITHOUT PRIMARY KEY for faster inserts
INFO     sync_engine:sync_engine.py:151 Starting test sync from  to  (limit: 100 rows)
INFO     sync_engine:sync_engine.py:431 ================================================================================
INFO     sync_engine:sync_engine.py:432 Starting limited sync:  -> 
INFO     sync_engine:sync_engine.py:433 Row limit: 100, Batch size: 10000
INFO     sync_engine:sync_engine.py:434 ================================================================================
INFO     sync_engine:sync_engine.py:447 [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 100
INFO     sync_engine:sync_engine.py:449 [ORACLE] Query executed successfully
INFO     sync_engine:sync_engine.py:368 [BATCH 1] Preparing to fetch 100 rows (total so far: 0, remaining: 100)
INFO     sync_engine:sync_engine.py:283 [ORACLE] Fetching batch from Oracle...
INFO     sync_engine:sync_engine.py:291 [ORACLE] Fetched 0 rows from Oracle in 0.00s
INFO     sync_engine:sync_engine.py:304 [PROCESS] Converting datetime objects...
INFO     sync_engine:sync_engine.py:307 [PROCESS] Converted 0 rows
INFO     sync_engine:sync_engine.py:322 [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
INFO     sync_engine:sync_engine.py:326 [DUCKDB] Total insert completed in 0.00s
INFO     sync_engine:sync_engine.py:383 [PROGRESS] Total rows processed: 0/100 (0.0%)
INFO     sync_engine:sync_engine.py:470 Sync progress - Table: , Total rows: 0, Batch size: 0
INFO     sync_engine:sync_engine.py:393 [COMPLETE] Got less than requested (0 < 100). End of data.
INFO     sync_engine:sync_engine.py:458 [CLEANUP] Closing Oracle cursor...
INFO     sync_engine:sync_engine.py:460 [CLEANUP] Cursor closed
INFO     sync_engine:sync_engine.py:262 ================================================================================
INFO     sync_engine:sync_engine.py:263 [SUMMARY] Test sync completed!
INFO     sync_engine:sync_engine.py:264 [SUMMARY] Total rows processed: 0
INFO     sync_engine:sync_engine.py:265 [SUMMARY] Row limit: 100
INFO     sync_engine:sync_engine.py:266 [SUMMARY] Total time: 0.01 seconds
INFO     sync_engine:sync_engine.py:269 [SUMMARY] Processing rate: 0.00 rows/second
INFO     sync_engine:sync_engine.py:270 ================================================================================
____________________ test_151_progress_callback_and_queue _____________________
test\test_sync_worker.py:273: in test_151_progress_callback_and_queue
    assert worker.total_rows == 10250  # 10000 + 250
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 0 == 10250
E    +  where 0 = <oracle_duckdb_sync.sync_worker.SyncWorker object at 0x000001A70D602060>.total_rows
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:03:06,684 - sync_engine - INFO - Getting schema for table 
2025-12-30 14:03:06,685 - sync_engine - INFO - Creating table  in DuckDB
2025-12-30 14:03:06,685 - sync_engine - INFO - Dropping existing test table 
2025-12-30 14:03:06,686 - sync_engine - INFO - Creating test table WITHOUT PRIMARY KEY for faster inserts
2025-12-30 14:03:06,687 - sync_engine - INFO - Starting test sync from  to  (limit: 1000 rows)
2025-12-30 14:03:06,687 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,687 - sync_engine - INFO - Starting limited sync:  -> 
2025-12-30 14:03:06,687 - sync_engine - INFO - Row limit: 1000, Batch size: 10000
2025-12-30 14:03:06,687 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,688 - sync_engine - INFO - [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
2025-12-30 14:03:06,689 - sync_engine - INFO - [ORACLE] Query executed successfully
2025-12-30 14:03:06,690 - sync_engine - INFO - [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
2025-12-30 14:03:06,690 - sync_engine - INFO - [ORACLE] Fetching batch from Oracle...
2025-12-30 14:03:06,691 - sync_engine - INFO - [ORACLE] Fetched 0 rows from Oracle in 0.00s
2025-12-30 14:03:06,692 - sync_engine - INFO - [PROCESS] Converting datetime objects...
2025-12-30 14:03:06,692 - sync_engine - INFO - [PROCESS] Converted 0 rows
2025-12-30 14:03:06,692 - sync_engine - INFO - [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
2025-12-30 14:03:06,692 - sync_engine - INFO - [DUCKDB] Total insert completed in 0.00s
2025-12-30 14:03:06,693 - sync_engine - INFO - [PROGRESS] Total rows processed: 0/1000 (0.0%)
2025-12-30 14:03:06,693 - sync_engine - INFO - Sync progress - Table: , Total rows: 0, Batch size: 0
2025-12-30 14:03:06,694 - sync_engine - INFO - [COMPLETE] Got less than requested (0 < 1000). End of data.
2025-12-30 14:03:06,694 - sync_engine - INFO - [CLEANUP] Closing Oracle cursor...
2025-12-30 14:03:06,695 - sync_engine - INFO - [CLEANUP] Cursor closed
2025-12-30 14:03:06,695 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,695 - sync_engine - INFO - [SUMMARY] Test sync completed!
2025-12-30 14:03:06,695 - sync_engine - INFO - [SUMMARY] Total rows processed: 0
2025-12-30 14:03:06,695 - sync_engine - INFO - [SUMMARY] Row limit: 1000
2025-12-30 14:03:06,695 - sync_engine - INFO - [SUMMARY] Total time: 0.01 seconds
2025-12-30 14:03:06,695 - sync_engine - INFO - [SUMMARY] Processing rate: 0.00 rows/second
2025-12-30 14:03:06,696 - sync_engine - INFO - ================================================================================
------------------------------ Captured log call ------------------------------
INFO     sync_engine:sync_engine.py:62 Getting schema for table 
INFO     sync_engine:sync_engine.py:135 Creating table  in DuckDB
INFO     sync_engine:sync_engine.py:139 Dropping existing test table 
INFO     sync_engine:sync_engine.py:145 Creating test table WITHOUT PRIMARY KEY for faster inserts
INFO     sync_engine:sync_engine.py:151 Starting test sync from  to  (limit: 1000 rows)
INFO     sync_engine:sync_engine.py:431 ================================================================================
INFO     sync_engine:sync_engine.py:432 Starting limited sync:  -> 
INFO     sync_engine:sync_engine.py:433 Row limit: 1000, Batch size: 10000
INFO     sync_engine:sync_engine.py:434 ================================================================================
INFO     sync_engine:sync_engine.py:447 [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
INFO     sync_engine:sync_engine.py:449 [ORACLE] Query executed successfully
INFO     sync_engine:sync_engine.py:368 [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
INFO     sync_engine:sync_engine.py:283 [ORACLE] Fetching batch from Oracle...
INFO     sync_engine:sync_engine.py:291 [ORACLE] Fetched 0 rows from Oracle in 0.00s
INFO     sync_engine:sync_engine.py:304 [PROCESS] Converting datetime objects...
INFO     sync_engine:sync_engine.py:307 [PROCESS] Converted 0 rows
INFO     sync_engine:sync_engine.py:322 [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
INFO     sync_engine:sync_engine.py:326 [DUCKDB] Total insert completed in 0.00s
INFO     sync_engine:sync_engine.py:383 [PROGRESS] Total rows processed: 0/1000 (0.0%)
INFO     sync_engine:sync_engine.py:470 Sync progress - Table: , Total rows: 0, Batch size: 0
INFO     sync_engine:sync_engine.py:393 [COMPLETE] Got less than requested (0 < 1000). End of data.
INFO     sync_engine:sync_engine.py:458 [CLEANUP] Closing Oracle cursor...
INFO     sync_engine:sync_engine.py:460 [CLEANUP] Cursor closed
INFO     sync_engine:sync_engine.py:262 ================================================================================
INFO     sync_engine:sync_engine.py:263 [SUMMARY] Test sync completed!
INFO     sync_engine:sync_engine.py:264 [SUMMARY] Total rows processed: 0
INFO     sync_engine:sync_engine.py:265 [SUMMARY] Row limit: 1000
INFO     sync_engine:sync_engine.py:266 [SUMMARY] Total time: 0.01 seconds
INFO     sync_engine:sync_engine.py:269 [SUMMARY] Processing rate: 0.00 rows/second
INFO     sync_engine:sync_engine.py:270 ================================================================================
______________________ test_151_progress_queue_optional _______________________
test\test_sync_worker.py:358: in test_151_progress_queue_optional
    assert worker.total_rows == 50
E   assert 0 == 50
E    +  where 0 = <oracle_duckdb_sync.sync_worker.SyncWorker object at 0x000001A70D6022C0>.total_rows
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:03:06,731 - sync_engine - INFO - Getting schema for table 
2025-12-30 14:03:06,732 - sync_engine - INFO - Creating table  in DuckDB
2025-12-30 14:03:06,733 - sync_engine - INFO - Dropping existing test table 
2025-12-30 14:03:06,733 - sync_engine - INFO - Creating test table WITHOUT PRIMARY KEY for faster inserts
2025-12-30 14:03:06,733 - sync_engine - INFO - Starting test sync from  to  (limit: 100 rows)
2025-12-30 14:03:06,733 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,734 - sync_engine - INFO - Starting limited sync:  -> 
2025-12-30 14:03:06,734 - sync_engine - INFO - Row limit: 100, Batch size: 10000
2025-12-30 14:03:06,734 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,735 - sync_engine - INFO - [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 100
2025-12-30 14:03:06,735 - sync_engine - INFO - [ORACLE] Query executed successfully
2025-12-30 14:03:06,736 - sync_engine - INFO - [BATCH 1] Preparing to fetch 100 rows (total so far: 0, remaining: 100)
2025-12-30 14:03:06,736 - sync_engine - INFO - [ORACLE] Fetching batch from Oracle...
2025-12-30 14:03:06,737 - sync_engine - INFO - [ORACLE] Fetched 0 rows from Oracle in 0.00s
2025-12-30 14:03:06,738 - sync_engine - INFO - [PROCESS] Converting datetime objects...
2025-12-30 14:03:06,738 - sync_engine - INFO - [PROCESS] Converted 0 rows
2025-12-30 14:03:06,739 - sync_engine - INFO - [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
2025-12-30 14:03:06,739 - sync_engine - INFO - [DUCKDB] Total insert completed in 0.00s
2025-12-30 14:03:06,740 - sync_engine - INFO - [PROGRESS] Total rows processed: 0/100 (0.0%)
2025-12-30 14:03:06,740 - sync_engine - INFO - Sync progress - Table: , Total rows: 0, Batch size: 0
2025-12-30 14:03:06,740 - sync_engine - INFO - [COMPLETE] Got less than requested (0 < 100). End of data.
2025-12-30 14:03:06,740 - sync_engine - INFO - [CLEANUP] Closing Oracle cursor...
2025-12-30 14:03:06,741 - sync_engine - INFO - [CLEANUP] Cursor closed
2025-12-30 14:03:06,741 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,741 - sync_engine - INFO - [SUMMARY] Test sync completed!
2025-12-30 14:03:06,741 - sync_engine - INFO - [SUMMARY] Total rows processed: 0
2025-12-30 14:03:06,742 - sync_engine - INFO - [SUMMARY] Row limit: 100
2025-12-30 14:03:06,742 - sync_engine - INFO - [SUMMARY] Total time: 0.01 seconds
2025-12-30 14:03:06,742 - sync_engine - INFO - [SUMMARY] Processing rate: 0.00 rows/second
2025-12-30 14:03:06,742 - sync_engine - INFO - ================================================================================
------------------------------ Captured log call ------------------------------
INFO     sync_engine:sync_engine.py:62 Getting schema for table 
INFO     sync_engine:sync_engine.py:135 Creating table  in DuckDB
INFO     sync_engine:sync_engine.py:139 Dropping existing test table 
INFO     sync_engine:sync_engine.py:145 Creating test table WITHOUT PRIMARY KEY for faster inserts
INFO     sync_engine:sync_engine.py:151 Starting test sync from  to  (limit: 100 rows)
INFO     sync_engine:sync_engine.py:431 ================================================================================
INFO     sync_engine:sync_engine.py:432 Starting limited sync:  -> 
INFO     sync_engine:sync_engine.py:433 Row limit: 100, Batch size: 10000
INFO     sync_engine:sync_engine.py:434 ================================================================================
INFO     sync_engine:sync_engine.py:447 [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 100
INFO     sync_engine:sync_engine.py:449 [ORACLE] Query executed successfully
INFO     sync_engine:sync_engine.py:368 [BATCH 1] Preparing to fetch 100 rows (total so far: 0, remaining: 100)
INFO     sync_engine:sync_engine.py:283 [ORACLE] Fetching batch from Oracle...
INFO     sync_engine:sync_engine.py:291 [ORACLE] Fetched 0 rows from Oracle in 0.00s
INFO     sync_engine:sync_engine.py:304 [PROCESS] Converting datetime objects...
INFO     sync_engine:sync_engine.py:307 [PROCESS] Converted 0 rows
INFO     sync_engine:sync_engine.py:322 [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
INFO     sync_engine:sync_engine.py:326 [DUCKDB] Total insert completed in 0.00s
INFO     sync_engine:sync_engine.py:383 [PROGRESS] Total rows processed: 0/100 (0.0%)
INFO     sync_engine:sync_engine.py:470 Sync progress - Table: , Total rows: 0, Batch size: 0
INFO     sync_engine:sync_engine.py:393 [COMPLETE] Got less than requested (0 < 100). End of data.
INFO     sync_engine:sync_engine.py:458 [CLEANUP] Closing Oracle cursor...
INFO     sync_engine:sync_engine.py:460 [CLEANUP] Cursor closed
INFO     sync_engine:sync_engine.py:262 ================================================================================
INFO     sync_engine:sync_engine.py:263 [SUMMARY] Test sync completed!
INFO     sync_engine:sync_engine.py:264 [SUMMARY] Total rows processed: 0
INFO     sync_engine:sync_engine.py:265 [SUMMARY] Row limit: 100
INFO     sync_engine:sync_engine.py:266 [SUMMARY] Total time: 0.01 seconds
INFO     sync_engine:sync_engine.py:269 [SUMMARY] Processing rate: 0.00 rows/second
INFO     sync_engine:sync_engine.py:270 ================================================================================
________________________ test_152_pause_resume_control ________________________
test\test_sync_worker.py:436: in test_152_pause_resume_control
    worker.pause()
    ^^^^^^^^^^^^
E   AttributeError: 'SyncWorker' object has no attribute 'pause'
---------------------------- Captured stdout call -----------------------------
2025-12-30 14:03:06,777 - sync_engine - INFO - Getting schema for table 
2025-12-30 14:03:06,778 - sync_engine - INFO - Creating table  in DuckDB
2025-12-30 14:03:06,779 - sync_engine - INFO - Dropping existing test table 
2025-12-30 14:03:06,779 - sync_engine - INFO - Creating test table WITHOUT PRIMARY KEY for faster inserts
2025-12-30 14:03:06,780 - sync_engine - INFO - Starting test sync from  to  (limit: 1000 rows)
2025-12-30 14:03:06,780 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,780 - sync_engine - INFO - Starting limited sync:  -> 
2025-12-30 14:03:06,781 - sync_engine - INFO - Row limit: 1000, Batch size: 10000
2025-12-30 14:03:06,781 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,782 - sync_engine - INFO - [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
2025-12-30 14:03:06,783 - sync_engine - INFO - [ORACLE] Query executed successfully
2025-12-30 14:03:06,783 - sync_engine - INFO - [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
2025-12-30 14:03:06,783 - sync_engine - INFO - [ORACLE] Fetching batch from Oracle...
2025-12-30 14:03:06,785 - sync_engine - INFO - [ORACLE] Fetched 0 rows from Oracle in 0.00s
2025-12-30 14:03:06,785 - sync_engine - INFO - [PROCESS] Converting datetime objects...
2025-12-30 14:03:06,786 - sync_engine - INFO - [PROCESS] Converted 0 rows
2025-12-30 14:03:06,787 - sync_engine - INFO - [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
2025-12-30 14:03:06,787 - sync_engine - INFO - [DUCKDB] Total insert completed in 0.00s
2025-12-30 14:03:06,788 - sync_engine - INFO - [PROGRESS] Total rows processed: 0/1000 (0.0%)
2025-12-30 14:03:06,788 - sync_engine - INFO - Sync progress - Table: , Total rows: 0, Batch size: 0
2025-12-30 14:03:06,788 - sync_engine - INFO - [COMPLETE] Got less than requested (0 < 1000). End of data.
2025-12-30 14:03:06,789 - sync_engine - INFO - [CLEANUP] Closing Oracle cursor...
2025-12-30 14:03:06,790 - sync_engine - INFO - [CLEANUP] Cursor closed
2025-12-30 14:03:06,790 - sync_engine - INFO - ================================================================================
2025-12-30 14:03:06,791 - sync_engine - INFO - [SUMMARY] Test sync completed!
2025-12-30 14:03:06,791 - sync_engine - INFO - [SUMMARY] Total rows processed: 0
2025-12-30 14:03:06,792 - sync_engine - INFO - [SUMMARY] Row limit: 1000
2025-12-30 14:03:06,793 - sync_engine - INFO - [SUMMARY] Total time: 0.01 seconds
2025-12-30 14:03:06,794 - sync_engine - INFO - [SUMMARY] Processing rate: 0.00 rows/second
2025-12-30 14:03:06,794 - sync_engine - INFO - ================================================================================
------------------------------ Captured log call ------------------------------
INFO     sync_engine:sync_engine.py:62 Getting schema for table 
INFO     sync_engine:sync_engine.py:135 Creating table  in DuckDB
INFO     sync_engine:sync_engine.py:139 Dropping existing test table 
INFO     sync_engine:sync_engine.py:145 Creating test table WITHOUT PRIMARY KEY for faster inserts
INFO     sync_engine:sync_engine.py:151 Starting test sync from  to  (limit: 1000 rows)
INFO     sync_engine:sync_engine.py:431 ================================================================================
INFO     sync_engine:sync_engine.py:432 Starting limited sync:  -> 
INFO     sync_engine:sync_engine.py:433 Row limit: 1000, Batch size: 10000
INFO     sync_engine:sync_engine.py:434 ================================================================================
INFO     sync_engine:sync_engine.py:447 [ORACLE] Executing query: SELECT * FROM (SELECT * FROM ) WHERE ROWNUM <= 1000
INFO     sync_engine:sync_engine.py:449 [ORACLE] Query executed successfully
INFO     sync_engine:sync_engine.py:368 [BATCH 1] Preparing to fetch 1000 rows (total so far: 0, remaining: 1000)
INFO     sync_engine:sync_engine.py:283 [ORACLE] Fetching batch from Oracle...
INFO     sync_engine:sync_engine.py:291 [ORACLE] Fetched 0 rows from Oracle in 0.00s
INFO     sync_engine:sync_engine.py:304 [PROCESS] Converting datetime objects...
INFO     sync_engine:sync_engine.py:307 [PROCESS] Converted 0 rows
INFO     sync_engine:sync_engine.py:322 [DUCKDB] Starting insert of 0 rows into DuckDB table ''...
INFO     sync_engine:sync_engine.py:326 [DUCKDB] Total insert completed in 0.00s
INFO     sync_engine:sync_engine.py:383 [PROGRESS] Total rows processed: 0/1000 (0.0%)
INFO     sync_engine:sync_engine.py:470 Sync progress - Table: , Total rows: 0, Batch size: 0
INFO     sync_engine:sync_engine.py:393 [COMPLETE] Got less than requested (0 < 1000). End of data.
INFO     sync_engine:sync_engine.py:458 [CLEANUP] Closing Oracle cursor...
INFO     sync_engine:sync_engine.py:460 [CLEANUP] Cursor closed
INFO     sync_engine:sync_engine.py:262 ================================================================================
INFO     sync_engine:sync_engine.py:263 [SUMMARY] Test sync completed!
INFO     sync_engine:sync_engine.py:264 [SUMMARY] Total rows processed: 0
INFO     sync_engine:sync_engine.py:265 [SUMMARY] Row limit: 1000
INFO     sync_engine:sync_engine.py:266 [SUMMARY] Total time: 0.01 seconds
INFO     sync_engine:sync_engine.py:269 [SUMMARY] Processing rate: 0.00 rows/second
INFO     sync_engine:sync_engine.py:270 ================================================================================
______________________ test_152_pause_state_transitions _______________________
test\test_sync_worker.py:519: in test_152_pause_state_transitions
    worker.pause()
    ^^^^^^^^^^^^
E   AttributeError: 'SyncWorker' object has no attribute 'pause'
============================== warnings summary ===============================
test\test_e2e.py:102
  D:\00_TestProject\oracle-duckdb-sync\test\test_e2e.py:102: PytestUnknownMarkWarning: Unknown pytest.mark.e2e - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.e2e

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED test/test_cached_query_v2.py::TestQueryDuckDBTableCached::test_handles_conversion_failure
FAILED test/test_data_converter.py::TestNumericStringDetection::test_pure_numeric_strings
FAILED test/test_data_converter.py::TestNumericStringDetection::test_float_strings
FAILED test/test_data_converter.py::TestNumericStringDetection::test_mixed_with_nulls
FAILED test/test_data_converter.py::TestNumericStringDetection::test_non_numeric_strings
FAILED test/test_data_converter.py::TestNumericStringDetection::test_mostly_numeric
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_yyyymmddhhmmss_format
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_yyyymmdd_format
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_iso_format
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_slash_format
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_non_datetime_strings
FAILED test/test_data_converter.py::TestDatetimeStringDetection::test_numeric_but_not_datetime
FAILED test/test_duckdb_source.py::test_050_batch_insert - AssertionError: Ex...
FAILED test/test_e2e.py::test_131_incremental_sync_e2e_real_db - Exception: T...
FAILED test/test_oracle_source.py::test_020_oracle_connection_creation - KeyE...
FAILED test/test_performance.py::test_133_incremental_sync_performance_10k_rows
FAILED test/test_state_rollback.py::test_142_state_rollback_on_failure_and_restart
FAILED test/test_streamlit_ui.py::test_streamlit_ui_responsiveness - playwrig...
FAILED test/test_sync_worker.py::test_150_sync_worker_thread_lifecycle - asse...
FAILED test/test_sync_worker.py::test_150_sync_worker_error_handling - Assert...
FAILED test/test_sync_worker.py::test_151_progress_callback_and_queue - asser...
FAILED test/test_sync_worker.py::test_151_progress_queue_optional - assert 0 ...
FAILED test/test_sync_worker.py::test_152_pause_resume_control - AttributeErr...
FAILED test/test_sync_worker.py::test_152_pause_state_transitions - Attribute...
================= 24 failed, 169 passed, 1 warning in 29.78s ==================
